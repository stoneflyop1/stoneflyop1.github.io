---
layout: post

title: 概率论及其应用-02组合分析概要

description: 《概率论及其应用》读书笔记

category: statistics

tags: [sample, combinatorial]
---

## 预备知识

依次序有r个步骤，每个步骤k有 $n_k$ 种选择方式，则可以得到 $n_1·n_2·...·n_r$ 种不同的结果。

## 有序样本

> 从大小为n的总体中依次抽取r个元素，实验的可能结果就是这些大小为r的样本。他们的总数是 $n^r$ 或者 $(n)_r$，随抽取的方式是否有放回而定。无论哪一种情况，我们的理想实验是用样本空间来描述的，其中每一个个别的点都代表大小为r的一个样本。

一般地，“随机样本”表示各个样本点具有相同的概率。有放回的样本概率为 $n^{-r}$，无放回的概率则为 $1/(n)_r$。若n远远大于r，则两个值接近相等。
> 扔硬币、掷骰子和类似的一些游戏，都可以解释为有放回的随机抽样实验，并且我们所赋给的概率很接近于长期持续实验下所观察到的频率，即使完全均匀的硬币和骰子并不存在。从一副洗得很好的纸牌中，连续地进行抽取，就是无放回抽样的一个典型例子。

根据随机抽样的有放回和无放回两种实验，可知r个样本没有重复元素的事件概率为：

$$ p = \frac{(n)_r}{n^r} $$

## 子总体(Subpopulations)和分划(Partitions)

### 子总体

从大小为n的总体选r个元素构成一个大小为r的子总体。

> 对这个子总体中元素随意编号将其转化为大小为r的有序样本，每个这样的样本都可以用这种方式获得。既然r个元素有$r!$种不同标号方式(排列)，由此可得样本的个数是大小为r的子总体个数的$r!$倍，所以大小为r的子总体个数为$(n)_r / r!$，记为：$ \left( \begin{array}{c} n \\ r \end{array} \right) $，称为二项式系数。

__定理1 一个包含n个元素的总体可以产生$ \left( \begin{array}{c} n \\ r \end{array} \right) $个不同的子总体 $ (r \leqslant n) $__

> 从n个元素中可以用$ \\left( \\begin{array}{c} n \\\\ r \\end{array} \\right) $种不同方法选出包含r个元素的子总体。因为从n个元素总体选取r个元素和留下n-r个是等价的，因此：

$$ \left( \begin{array}{c} n \\ r \end{array} \right) = \left( \begin{array}{c} n \\ (n-r) \end{array} \right) $$

### 占位问题 续

r个球随机分布于n个盒中的问题，考虑一个给定盒子中恰好包含k个球的概率$p_k$
> 我们首先注意：k个球可以有$ \left( \begin{array}{c} r \\ k \end{array} \right) $种选取方式，剩下的n-1个盒的方式有$(n-1)^{r-k}$种，由此推出：

$$ p_k = \left(  \begin{array}{c} r \\ k \end{array} \right) \centerdot \frac{1}{n^r} \centerdot (n-1)^{r-k} = \left( \begin{array}{c} r \\ k \end{array} \right)  \centerdot \frac{1}{n^k} \centerdot (1-\frac{1}{n})^{r-k} $$

> 可分辨与不可分辨的元素的区别类似于子总体与相应的有序样本之间的关系。删去一个有r个元素$a_1,...,a_r$构成的排列的全部下标，就得到一个由r个不可辨别的字母构成的排列。反之，把r个字母各标以一个数字，就得到了一个由字母$a_1,...,a_r$构成的排列。这种办法可以提供$r!$种不同排列；显然，变换$a_i$和$a_k$的位置得到一次重排。

定理2 令 $ r_1,...,r_k$为满足

$$ r_1 + r_2 + ... + r_k = n, r_i \geqslant 0 $$

的整数。把一个包含n个元素的总体分成k个有序的部分(分为k个子体)，其中第一部分包含$r_1$个元素，第二部分包含$r_2$个元素，等等，这种分法共有

$$ \frac{n!}{r_{1}!r_{2}!...r_{k}!} $$

__注意：子总体之间的次序是必要的，譬如($r_1 = 2, r_2 = 3$)和($r_1 = 3, r_2 = 2$)代表不同分法；然而，组内的次序是无关紧要的。__

## 在占位问题(Occupancy Problem)中的应用

占位问题可以表明，给基础样本点概率赋值是有讲究的。

> 把r个球随机放入n个盒的模型具有广泛的应用。在许多场合，需要处理不可分辨的球。例如，工作日中事故分布的统计研究。日历中生日的分布，人们仅仅对发生的次数感兴趣，并不对事故中的个体感兴趣。再比如，掷r颗骰子等价于把r个球置于n=6个盒中。虽然可能追踪r颗骰子的结果，但主要的是关心幺点、两点等等的个数。在这些场合，我们仍然假定这些球是标有号码的，但我们的注意力主要集中在这样一些事件，它们与标号无关。

$r_k$表示第k个盒子装有的球数，则有：

$$ r_1 + r_2 +...+ r_n = r, r_k \geqslant 0 $$

只有当对应的n元组$(r_1, r_2,...,r_n)$不恒等时，不可辨球的下列两类分布才是不同的：

- 可区别的分布的数目是：$ A_{r,n} = \left( \begin{array}{c} {n+r-1} \\ r \end{array} \right) = \left( \begin{array}{c} {n+r-1} \\ {n-1} \end{array} \right)  $
- 没有一个盒是空的可区别的分布的数目是：$ \left(  \begin{array}{c} {r-1} \\ {n-1} \end{array} \right) $
- \|\*\*\*\|\*\|\|\|\|\*\*\*\*\| (r=8个球放于n=6个盒中的示例)

如上有n+1个\|，r个\*，其中n-1条\|和r个\*可任意排列；对于没有空盒的情况，即没有两条\|是靠在一起的。但r个\*有r-1个空位，由n-1个\|来填充。

麦克斯韦-玻尔兹曼分布(盒可分辨情况)：把r个球置于n个盒中的放法的数目，归结为占位数$r_1,...r_n$。假定全部的$n^r$种放法都是等可能的。占位数的概率为：

$$ \frac{r!}{ {r_1}! {r_2}! ... {r_n}! } n^{-r} $$

波色-爱因斯坦统计：r个质点和n个盒，仅考虑可区分的排列，每个排列赋以相等的概率$1/A_{r,n}$(见前文公式)。

费米-狄拉克假设：
- 2个或多个质点在同一个盒中是不可能的(要求：$r \leqslant n$)，即：每一种排列都相当于从n个盒中选择r个质点放入不重复的盒中。排列数：$\begin{array}{c} n \\ r \end{array}$
- 满足上一个条件的所有的可区分的排列具有相同的概率

### 连贯(Run)

> 在任一有两类元素构成的有序序列中，由同一类元素所组成的最大的子序列称为一个连贯。

随机性检验：
> 连贯数目过多就表示人为的故意混合；连贯数太少表示人为的故意集结。当然，这些结论并不是很可靠。但是，有效的统计技巧已经大大地发展了，它在实践中大大缩小了做出错误结论的危险性。
> ... 
> 在生物的现场实验中，我们计算健壮作物和有病作物的连贯。有病作物的长连贯提示疾病的蔓延。气象学家留心干燥和潮湿月份的连续现象，借以发现气候的持续现象的线索。

齐次性问题(problem of homogeneity)：
> 在实践中，我们有两组观察结果，譬如说 $\alpha_1,\alpha_2,...,\alpha_a$和$\beta_1,\beta_2,...,\beta_b$分别对应于两种处理或者说分别对应于两个总体的元素的某一特性。$\alpha$和$\beta$都是数，我们假定它按照大小次序排列：$\alpha_1 \leqslant \alpha_2 \leqslant ... \leqslant \alpha_a; \beta_1 \leqslant \beta_2 \leqslant ... \leqslant \beta_b$，我们把这两组数合在一起，并按照大小次序排列。一个极端的情况是全部$\alpha$都在全部$\beta$前面，这种现象可以用来指出这两种处理或者两个总体之间有差异。另一方面，如果两种处理都一样，则$\alpha$和$\beta$或多或少以随机次序出现。沃尔德(A. Wald)和沃尔夫维茨曾经证明了：连贯理论常常能很方便地用来发现微小的系统误差。

## 超几何分布(The Hypergeometric Distribution)

在n个元素的总体里，$n_1$个是红的，$n_2 = n-n_1$个是黑的。任意选取r个元素组成一组。试求所取出的这一组中，恰有k个红元素的概率$q_k$。其中k为整数，且$ 0 \leqslant k \leqslant min(r,n_1) $

$$ q_k = \frac{ \left( \begin{array}{c} r \\ k \end{array} \right)  \left( \begin{array}{c} {n-r} \\ {n_{1}-k} \end{array} \right) }{\left( \begin{array}{c} n \\ n_1 \end{array} \right)} $$

## 等待时间的例子

占位问题(r个球放入n个盒)：

我们事先不固定球的个数r，而是让球一个接一个的投入小盒，一直到我们指定的结果出现为止。(i) 球一个接一个的往盒里随机放置，一直到有一个球放入某一个已经有球的盒为止。(ii) 我们固定一个盒，当这个固定的盒还空时，我们就持续随机放入小球入盒；一旦此盒放入小球即停止。

实例：生日问题(n=365)：

(i) 如果我们一个接一个地随机选人，问需要选取多少次才能发现有两个人为同一天生日？

(ii)  轮到我的生日在样本中出现需要选取多少人。

模型(i)

对于一个固定的r，全部形如$(j_1,...,j_r)$的样本点的总和代表事件“过程在第r步结束”。数$j_1,...j_r$有$(n)_{r_1}$种不同的选取法，而$j_r$只能取$j_1,...j_r$这r-1个数中的一个。因此，过程在第r步结束的概率为(固定r后的样本点的基础概率为$n^{-r}$)：

$$ q_r = \frac{(n)_{r-1} \centerdot (r-1) }{n^r}  = (1-\frac{1}{n})...(1-\frac{r-2}{n}) \centerdot \frac{r-1}{n} $$

其中： $q_1 = 0, q_2 = \frac{1}{n}$，第r步以后结束的概率为：

$$ p_r = 1- (q_1 + q_2 +...+ q_r) = \frac{(n)_r}{n^r} = (1-\frac{1}{n})...(1-\frac{r-1}{n}) $$

模型(ii)

依赖于一个无穷的样本空间。序列$(j_1,...j_r)$满足条件：$j_1,...,j_r$都不等于给定的数$a \leqslant n$，而 $j_r = a$。此外，没有充分的理由说明过程为什么总要结束。对于一个固定的r，我们可以对每一个形如$(j_1,...j_r)$的样本点，都赋以概率$n^{-r}$。$j_1,...,j_r$中每一个都有n-1中不同的选法，而$j_r$仅有一种。所以过程在第r步结束的概率为：

$$ {q_r}^* = (\frac{n-1}{n})^{r-1} \centerdot \frac{1}{n}, r=1,2,... $$

我们有：

$$ {q_1}^*+{q_2}^*+...=1 $$

因此无需引入一个样本点表示从来没有一个球放入给定的盒a中。过程在第r步以后才结束的概率：

$$ {p_r}^* = 1-({q_1}^*+...+{q_r}^*) = (1-\frac{1}{n})^r, r=1,2,... $$

中位数：

分布{$p_r$}的中位数定义为这样的r：它使得$p_1+...+p_{r-1} \leqslant \frac{1}{2}$，但$p_1+...+p_r > \frac{1}{2}$。

